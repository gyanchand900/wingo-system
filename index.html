<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Wingo Final System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
body{background:#000;color:#fff;font-family:Arial}
.box{border:1px solid #333;padding:8px;margin:6px;text-align:center}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #333;padding:6px;text-align:center}
.big{color:#00ff7f}
.small{color:#ff4d4d}
.stable{color:#00ff7f}
.break{color:#ff4d4d}
.breaker{color:#ff9800}
</style>
</head>
<body>

<h3>ðŸ“Š Wingo System</h3>

<div class="box">
Signal: <span id="signal">-</span><br>
Strength: <span id="strength">0</span>%<br>
ðŸ”® Prediction: <span id="pred">WAIT</span>
</div>

<div class="box">
ðŸŽ¯ Accuracy: <span id="acc">0</span>%<br>
ðŸŸ¦ Big Breaks: <span id="bb">0</span> |
ðŸŸ§ Small Breaks: <span id="sb">0</span>
</div>

<table>
<thead>
<tr><th>Period</th><th>Number</th><th>BS</th></tr>
</thead>
<tbody id="rows"></tbody>
</table>

<script>
const BACKEND_URL = "https://wingo-system.onrender.com";

async function loadState(){
  const r = await fetch(BACKEND_URL+"/state");
  const d = await r.json();

  document.getElementById("signal").innerText = d.signal;
  document.getElementById("signal").className = d.signal.toLowerCase();
  document.getElementById("pred").innerText = d.prediction;
  document.getElementById("strength").innerText = d.strength;
  document.getElementById("acc").innerText = d.accuracy;
  document.getElementById("bb").innerText = d.breakerSplit.Big;
  document.getElementById("sb").innerText = d.breakerSplit.Small;

  const tb=document.getElementById("rows");
  tb.innerHTML="";
  d.history.slice().reverse().forEach(x=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${x.period}</td>
      <td>${x.number}</td>
      <td class="${x.bs==="Big"?"big":"small"}">${x.bs}</td>
    `;
    tb.appendChild(tr);
  });
}

async function fetchAPI(){
  const r = await fetch("https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json");
  const j = await r.json();
  const item=j.data.list[0];

  await fetch(BACKEND_URL+"/push",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      period:item.issueNumber,
      number:item.number
    })
  });

  loadState();
}

loadState();
setInterval(fetchAPI,3000);
</script>

</body>
</html>
